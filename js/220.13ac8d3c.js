"use strict";(self["webpackChunkisland_travel"]=self["webpackChunkisland_travel"]||[]).push([[220],{9335:function(t,e,s){s.d(e,{Z:function(){return g}});var a=s(6252);const l={class:"modal fade",tabindex:"-1",ref:"cautionModal",id:"cautionModal"},o={class:"modal-dialog"},i={class:"modal-content"},d=(0,a._)("div",{class:"modal-header"},[(0,a._)("h5",{class:"modal-title"},"移除商品"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),n=(0,a._)("div",{class:"modal-body"},[(0,a._)("p",null,"您確定要移除此商品嗎？")],-1),c={class:"modal-footer"},r=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function u(t,e,s,u,m,p){return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",o,[(0,a._)("div",i,[d,n,(0,a._)("div",c,[r,(0,a._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-product"))}," 確定移除")])])])],512)}var m=s(7424),p=s.n(m),_={data(){return{modal:""}},props:{item:{}},emits:["del-product"],methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(p())(this.$refs.cautionModal)}},h=s(3744);const b=(0,h.Z)(_,[["render",u]]);var g=b},8643:function(t,e,s){s.d(e,{Z:function(){return g}});var a=s(6252);const l={class:"modal fade",tabindex:"-1",ref:"cautionModal",id:"cautionModal"},o={class:"modal-dialog"},i={class:"modal-content"},d=(0,a._)("div",{class:"modal-header"},[(0,a._)("h5",{class:"modal-title"},"清空購物車"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),n=(0,a._)("div",{class:"modal-body"},[(0,a._)("p",null,"您確定要清空購物車裡面的商品嗎？")],-1),c={class:"modal-footer"},r=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function u(t,e,s,u,m,p){return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",o,[(0,a._)("div",i,[d,n,(0,a._)("div",c,[r,(0,a._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e[0]||(e[0]=e=>t.$emit("clear-item"))},"確定清空")])])])],512)}var m=s(7424),p=s.n(m),_={data(){return{modal:""}},emits:["clear-item"],methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(p())(this.$refs.cautionModal)}},h=s(3744);const b=(0,h.Z)(_,[["render",u]]);var g=b},8220:function(t,e,s){s.r(e),s.d(e,{default:function(){return dt}});var a=s(6252),l=s(3577),o=s(9963);const i=(0,a._)("div",{class:"section"},[(0,a._)("div",{class:"background-image background-image--cart"}),(0,a._)("div",{class:"background-title"},[(0,a._)("h2",{class:"fw-bold"},"購物車")])],-1),d={class:"container mb-5"},n=(0,a._)("ul",{class:"p-steps list-unstyled mt-5 mb-5"},[(0,a._)("li",{class:"col-4 is-active mb-md-0 mb-3"},[(0,a._)("small",null,"STEP1"),(0,a._)("p",null,"購物車")]),(0,a._)("li",{class:"col-4 mb-md-0 mb-3"},[(0,a._)("small",null,"STEP2"),(0,a._)("p",null,"填寫資料")]),(0,a._)("li",{class:"col-4"},[(0,a._)("small",null,"STEP3"),(0,a._)("p",null,"完成訂單")])],-1),c=(0,a._)("div",{class:"d-flex justify-content-center align-items-center mb-5"},[(0,a._)("h3",{class:"section-heading"},"購物車內容")],-1),r={class:"table cart__table"},u=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col",class:"border-0"},"商品圖片"),(0,a._)("th",{scope:"col",class:"border-0"},"商品名稱"),(0,a._)("th",{scope:"col",class:"border-0"},"數量"),(0,a._)("th",{scope:"col",class:"border-0"},"單價"),(0,a._)("th",{scope:"col",class:"border-0"},"刪除")])],-1),m={scope:"row",class:"border-0 font-weight-normal py-4"},p=["src","alt"],_={class:"border-0 align-middle"},h={class:"mb-0 fw-bold ms-3 d-inline-block"},b={class:"border-0 align-middle"},g={class:"input-group cart__count"},v={class:"input-group input-group-sm"},f={class:"input-group mb-3"},w=["onUpdate:modelValue","onChange","disabled"],y=(0,a._)("option",{selected:""},"請選擇人數",-1),C=["value","selected"],M={class:"input-group-text"},k={class:"border-0 align-middle"},D={class:"mb-0 ms-auto"},$={class:"border-0 align-middle"},L=["onClick"],x={class:"cart__list d-md-none"},I={class:"d-flex justify-content-between"},U=["onClick"],z=["src","alt"],P={class:"cart__card__content"},Z={class:"input-group cart__count"},q={class:"input-group input-group-sm"},H={class:"input-group"},T=["onUpdate:modelValue","onChange","disabled"],Y=(0,a._)("option",{selected:""},"請選擇人數",-1),j=["value","selected"],V={class:"input-group-text"},W={class:"mb-0 ms-auto"},K={class:"cart__footer"},N={class:"cart__info"},E={class:"table"},S=(0,a._)("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"總金額",-1),F={class:"text-end border-0 px-0 pt-4"},R={class:"d-flex justify-content-between align-items-center"},A=["disabled"],B={class:"spinner-border spinner-border-sm",role:"status"},G=(0,a.Uk)(" 清空購物車 "),J=(0,a.Uk)("下一步"),O={key:1,class:"container--center"},Q=(0,a._)("p",null,"購物車內沒有商品唷",-1),X=(0,a.Uk)(" 開始旅程 ");function tt(t,e,s,tt,et,st){const at=(0,a.up)("VueLoading"),lt=(0,a.up)("RouterLink"),ot=(0,a.up)("CautionModal"),it=(0,a.up)("CautionDelModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(at,{active:et.isLoading},null,8,["active"]),i,(0,a._)("div",d,[et.cartData.carts.length?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[n,(0,a._)("div",null,[(0,a._)("div",null,[c,(0,a._)("table",r,[u,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(et.cartData.carts,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id,class:"border-bottom border-top"},[(0,a._)("th",m,[(0,a._)("img",{src:t.product.imageUrl,class:"cart__image",alt:t.product.title},null,8,p)]),(0,a._)("td",_,[(0,a._)("p",h,(0,l.zw)(t?.product?.title),1)]),(0,a._)("td",b,[(0,a._)("div",g,[(0,a._)("div",v,[(0,a._)("div",f,[(0,a.wy)((0,a._)("select",{class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>st.updateCartItem(t),disabled:et.isLoadingItem===t.id},[y,((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(20,(e=>(0,a._)("option",{value:e,selected:t.qty===e,key:`${e}-${t.id}`},(0,l.zw)(e),9,C))),64))],40,w),[[o.bM,t.qty]]),(0,a._)("span",M,(0,l.zw)(t?.product?.unit),1)])])])]),(0,a._)("td",k,[(0,a._)("p",D,"NT$ "+(0,l.zw)(t?.product?.price),1)]),(0,a._)("td",$,[(0,a._)("i",{class:"bi bi-trash-fill fs-5",role:"button",onClick:e=>st.openDelModal(t)},null,8,L)])])))),128))])]),(0,a._)("ul",x,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(et.cartData.carts,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"card cart__card",key:t.id},[(0,a._)("div",I,[(0,a._)("span",{class:"icon--close icon-close--sp cartNav__close",onClick:e=>st.openDelModal(t)},null,8,U),(0,a._)("img",{src:t.product.imageUrl,class:"cart__image",alt:t.product.title},null,8,z),(0,a._)("div",P,[(0,a.Uk)((0,l.zw)(t.product.title)+" ",1),(0,a._)("div",Z,[(0,a._)("div",q,[(0,a._)("div",H,[(0,a.wy)((0,a._)("select",{class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>st.updateCartItem(t),disabled:et.isLoadingItem===t.id},[Y,((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(20,(e=>(0,a._)("option",{value:e,selected:t.qty===e,key:`${e}-${t.id}`},(0,l.zw)(e),9,j))),64))],40,T),[[o.bM,t.qty]]),(0,a._)("span",V,(0,l.zw)(t?.product?.unit),1)])])]),(0,a._)("p",W,"小計: NT$ "+(0,l.zw)(t?.product?.price),1)])])])))),128))]),(0,a._)("div",K,[(0,a._)("div",N,[(0,a._)("table",E,[(0,a._)("tbody",null,[(0,a._)("tr",null,[S,(0,a._)("td",F,"NT$"+(0,l.zw)(et.cartData.total),1)])])])])]),(0,a._)("div",R,[(0,a._)("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=t=>st.openModal()),disabled:"clear"===et.isDisabled},[(0,a.wy)((0,a._)("span",B,null,512),[[o.F8,"clear"===et.isDisabled]]),G],8,A),(0,a.Wm)(lt,{to:"/confirm",class:"button--jump"},{default:(0,a.w5)((()=>[J])),_:1})])])])],64)):((0,a.wg)(),(0,a.iD)("div",O,[Q,(0,a.Wm)(lt,{class:"btn btn-primary",to:"/products",onClick:e[1]||(e[1]=e=>t.isClicked=!t.isClicked)},{default:(0,a.w5)((()=>[X])),_:1})]))]),(0,a.Wm)(ot,{ref:"cautionModal",onClearItem:st.clearCartItem},null,8,["onClearItem"]),(0,a.Wm)(it,{item:et.tempProduct,ref:"cautionDelModal",onDelProduct:st.removeCartItem},null,8,["item","onDelProduct"])],64)}var et=s(4902),st=s(8643),at=s(9335),lt={data(){return{cartData:{carts:[]},products:[],productId:"",isLoadingItem:"",isLoading:!1,isDisabled:"",tempProduct:{}}},components:{CautionModal:st.Z,CautionDelModal:at.Z},inject:["emitter"],methods:{getCart(){this.isLoading=!0,this.$http.get("https://vue3-course-api.hexschool.io/v2/api/shio-vue/cart").then((t=>{this.cartData=t.data.data,this.isLoading=!1})).catch((t=>{this.emitter.emit("push-message",{title:"找不到商品",content:t.response.data.message})}))},removeCartItem(t){this.isLoading=!0;const e=this.$refs.cautionDelModal;this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/shio-vue/cart/${this.tempProduct.id}`).then((t=>{this.getCart(),this.emitter.emit("push-message",{style:"success",title:"購物提示",content:t.data.message}),et.Z.emit("get-cart"),e.hideModal(),this.isLoading=!1})).catch((t=>{this.emitter.emit("push-message",{title:"移除失敗",content:t.response.data.message})}))},clearCartItem(){this.isLoading=!0;const t=this.$refs.cautionModal;this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/shio-vue/carts/").then((e=>{this.getCart(),this.isLoading=!1,this.emitter.emit("push-message",{title:"已清空購物車",content:e.data.message}),t.hideModal(),et.Z.emit("get-cart")})).catch((t=>{this.emitter.emit("push-message",{title:"清空失敗",content:t.response.data.message})}))},updateCartItem(t){const e={product_id:t.product.id,qty:t.qty};this.isLoading=!0,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/shio-vue/cart/${t.id}`,{data:e}).then((t=>{this.getCart(),this.isLoading=!1})).catch((t=>{this.emitter.emit("push-message",{title:"更新失敗",content:t.response.data.message})}))},openModal(){const t=this.$refs.cautionModal;t.openModal()},openDelModal(t){this.tempProduct={...t};const e=this.$refs.cautionDelModal;e.openModal()}},mounted(){this.getCart(),this.isClicked=!1}},ot=s(3744);const it=(0,ot.Z)(lt,[["render",tt]]);var dt=it}}]);
//# sourceMappingURL=220.13ac8d3c.js.map